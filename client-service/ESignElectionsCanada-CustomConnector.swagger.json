{
  "swagger": "2.0",
  "info": {
    "title": "ESign Elections Canada",
    "description": "Managed digital signature service powered by Nintex AssureSign. Submit envelopes, track status, and manage digital signatures without directly managing Nintex API integration. This connector interfaces with Leonardo Company's signature broker service.",
    "version": "1.0.0",
    "contact": {
      "name": "Leonardo Company Canada - Digital Signature Services",
      "email": "esign-support@leonardo.com"
    }
  },
  "host": "YOUR_BROKER_ENVIRONMENT.crm3.dynamics.com",
  "basePath": "/api/data/v9.2",
  "schemes": [
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "securityDefinitions": {
    "oauth2": {
      "type": "oauth2",
      "flow": "accessCode",
      "authorizationUrl": "https://login.microsoftonline.com/common/oauth2/v2.0/authorize",
      "tokenUrl": "https://login.microsoftonline.com/common/oauth2/v2.0/token",
      "scopes": {
        "https://YOUR_BROKER_ENVIRONMENT.crm3.dynamics.com/.default": "Access broker service"
      }
    }
  },
  "security": [
    {
      "oauth2": []
    }
  ],
  "paths": {
    "/cs_envelopes": {
      "post": {
        "summary": "Submit envelope for signature",
        "description": "Submit a new envelope for digital signature. This will create an envelope in the broker service, and upon approval (if required), will submit to Nintex AssureSign automatically.",
        "operationId": "SubmitEnvelope",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "cs_name": {
                  "type": "string",
                  "description": "Envelope name/title",
                  "x-ms-summary": "Envelope Name"
                },
                "cs_subject": {
                  "type": "string",
                  "description": "Email subject line for signers",
                  "x-ms-summary": "Subject"
                },
                "cs_message": {
                  "type": "string",
                  "description": "Email message body for signers",
                  "x-ms-summary": "Message"
                },
                "cs_templateid": {
                  "type": "string",
                  "description": "Nintex template ID (optional)",
                  "x-ms-summary": "Template ID"
                },
                "cs_daystoexpire": {
                  "type": "integer",
                  "description": "Days until envelope expires (default: 30)",
                  "x-ms-summary": "Days to Expire",
                  "default": 30
                },
                "cs_reminderfrequency": {
                  "type": "integer",
                  "description": "Days between reminder emails (default: 3)",
                  "x-ms-summary": "Reminder Frequency",
                  "default": 3
                },
                "cs_requestoremail": {
                  "type": "string",
                  "description": "Email of person requesting signature",
                  "x-ms-summary": "Requestor Email"
                },
                "cs_departmentname": {
                  "type": "string",
                  "description": "Your department/organization name",
                  "x-ms-summary": "Department"
                },
                "cs_requiresapproval": {
                  "type": "boolean",
                  "description": "Does this envelope require approval before sending? (default: false)",
                  "x-ms-summary": "Requires Approval",
                  "default": false
                }
              },
              "required": [
                "cs_name",
                "cs_subject",
                "cs_requestoremail"
              ]
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Envelope created successfully",
            "schema": {
              "type": "object",
              "properties": {
                "cs_envelopeid": {
                  "type": "string",
                  "description": "Unique envelope identifier in broker service"
                },
                "cs_name": {
                  "type": "string",
                  "description": "Envelope name"
                },
                "cs_status": {
                  "type": "string",
                  "description": "Current status (Pending Approval, Submitted, InProcess, Completed, Cancelled)"
                },
                "cs_nintexenvelopeid": {
                  "type": "string",
                  "description": "Nintex envelope ID (populated after submission)"
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List envelopes",
        "description": "Retrieve a list of envelopes you have access to",
        "operationId": "ListEnvelopes",
        "parameters": [
          {
            "name": "$filter",
            "in": "query",
            "type": "string",
            "description": "OData filter expression (e.g., cs_status eq 'Completed')",
            "x-ms-summary": "Filter",
            "required": false
          },
          {
            "name": "$select",
            "in": "query",
            "type": "string",
            "description": "Comma-separated list of fields to return",
            "x-ms-summary": "Select Columns",
            "required": false
          },
          {
            "name": "$top",
            "in": "query",
            "type": "integer",
            "description": "Number of records to return (max 5000)",
            "x-ms-summary": "Top",
            "required": false,
            "default": 100
          }
        ],
        "responses": {
          "200": {
            "description": "Envelopes retrieved",
            "schema": {
              "type": "object",
              "properties": {
                "value": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "cs_envelopeid": {
                        "type": "string",
                        "description": "Envelope ID"
                      },
                      "cs_name": {
                        "type": "string",
                        "description": "Envelope name"
                      },
                      "cs_status": {
                        "type": "string",
                        "description": "Current status"
                      },
                      "cs_sentdate": {
                        "type": "string",
                        "format": "date-time",
                        "description": "Date sent to signers"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/cs_envelopes({envelopeId})": {
      "get": {
        "summary": "Get envelope details",
        "description": "Retrieve detailed information about a specific envelope",
        "operationId": "GetEnvelope",
        "parameters": [
          {
            "name": "envelopeId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "Envelope ID (GUID)",
            "x-ms-summary": "Envelope ID",
            "x-ms-url-encoding": "single"
          }
        ],
        "responses": {
          "200": {
            "description": "Envelope details retrieved",
            "schema": {
              "type": "object",
              "properties": {
                "cs_envelopeid": {
                  "type": "string",
                  "description": "Envelope ID"
                },
                "cs_name": {
                  "type": "string",
                  "description": "Envelope name"
                },
                "cs_status": {
                  "type": "string",
                  "description": "Current status"
                },
                "cs_nintexenvelopeid": {
                  "type": "string",
                  "description": "Nintex envelope ID"
                },
                "cs_sentdate": {
                  "type": "string",
                  "format": "date-time",
                  "description": "Date sent"
                },
                "cs_completeddate": {
                  "type": "string",
                  "format": "date-time",
                  "description": "Date completed"
                }
              }
            }
          }
        }
      },
      "patch": {
        "summary": "Update envelope",
        "description": "Update envelope properties (e.g., cancel envelope by setting cs_iscancelled to true)",
        "operationId": "UpdateEnvelope",
        "parameters": [
          {
            "name": "envelopeId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "Envelope ID (GUID)",
            "x-ms-summary": "Envelope ID",
            "x-ms-url-encoding": "single"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "cs_iscancelled": {
                  "type": "boolean",
                  "description": "Set to true to cancel the envelope",
                  "x-ms-summary": "Is Cancelled"
                },
                "cs_notes": {
                  "type": "string",
                  "description": "Additional notes",
                  "x-ms-summary": "Notes"
                }
              }
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Envelope updated successfully"
          }
        }
      },
      "delete": {
        "summary": "Delete envelope",
        "description": "Delete an envelope (will cancel in Nintex if active)",
        "operationId": "DeleteEnvelope",
        "parameters": [
          {
            "name": "envelopeId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "Envelope ID (GUID)",
            "x-ms-summary": "Envelope ID",
            "x-ms-url-encoding": "single"
          }
        ],
        "responses": {
          "204": {
            "description": "Envelope deleted successfully"
          }
        }
      }
    },
    "/cs_signers": {
      "post": {
        "summary": "Add signer to envelope",
        "description": "Add a signer to an existing envelope. Must be done before envelope is submitted.",
        "operationId": "AddSigner",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "cs_email": {
                  "type": "string",
                  "description": "Signer email address",
                  "x-ms-summary": "Email"
                },
                "cs_fullname": {
                  "type": "string",
                  "description": "Signer full name",
                  "x-ms-summary": "Full Name"
                },
                "cs_signerorder": {
                  "type": "integer",
                  "description": "Signing order (1, 2, 3...)",
                  "x-ms-summary": "Signing Order",
                  "default": 1
                },
                "cs_phonenumber": {
                  "type": "string",
                  "description": "Phone number (optional)",
                  "x-ms-summary": "Phone Number"
                },
                "cs_envelopeid@odata.bind": {
                  "type": "string",
                  "description": "Related envelope (format: /cs_envelopes(guid))",
                  "x-ms-summary": "Envelope"
                }
              },
              "required": [
                "cs_email",
                "cs_fullname",
                "cs_envelopeid@odata.bind"
              ]
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Signer added successfully",
            "schema": {
              "type": "object",
              "properties": {
                "cs_signerid": {
                  "type": "string",
                  "description": "Signer record ID"
                },
                "cs_email": {
                  "type": "string",
                  "description": "Signer email"
                }
              }
            }
          }
        }
      }
    },
    "/cs_documents": {
      "post": {
        "summary": "Add document to envelope",
        "description": "Add a document to an existing envelope. Document content must be base64 encoded.",
        "operationId": "AddDocument",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "cs_filename": {
                  "type": "string",
                  "description": "Document filename (e.g., contract.pdf)",
                  "x-ms-summary": "Filename"
                },
                "cs_filecontent": {
                  "type": "string",
                  "description": "Base64 encoded document content",
                  "x-ms-summary": "File Content (Base64)"
                },
                "cs_documentorder": {
                  "type": "integer",
                  "description": "Document order (1, 2, 3...)",
                  "x-ms-summary": "Document Order",
                  "default": 1
                },
                "cs_envelopeid@odata.bind": {
                  "type": "string",
                  "description": "Related envelope (format: /cs_envelopes(guid))",
                  "x-ms-summary": "Envelope"
                }
              },
              "required": [
                "cs_filename",
                "cs_filecontent",
                "cs_envelopeid@odata.bind"
              ]
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Document added successfully",
            "schema": {
              "type": "object",
              "properties": {
                "cs_documentid": {
                  "type": "string",
                  "description": "Document record ID"
                },
                "cs_filename": {
                  "type": "string",
                  "description": "Document filename"
                }
              }
            }
          }
        }
      }
    },
    "/cs_envelopes({envelopeId})/cs_envelope_signer": {
      "get": {
        "summary": "Get envelope signers",
        "description": "Retrieve all signers for a specific envelope",
        "operationId": "GetEnvelopeSigners",
        "parameters": [
          {
            "name": "envelopeId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "Envelope ID (GUID)",
            "x-ms-summary": "Envelope ID",
            "x-ms-url-encoding": "single"
          }
        ],
        "responses": {
          "200": {
            "description": "Signers retrieved",
            "schema": {
              "type": "object",
              "properties": {
                "value": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "cs_signerid": {
                        "type": "string",
                        "description": "Signer ID"
                      },
                      "cs_email": {
                        "type": "string",
                        "description": "Email address"
                      },
                      "cs_fullname": {
                        "type": "string",
                        "description": "Full name"
                      },
                      "cs_signerstatus": {
                        "type": "string",
                        "description": "Signer status"
                      },
                      "cs_signinglink": {
                        "type": "string",
                        "description": "Signing URL"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/cs_templates": {
      "get": {
        "summary": "List available templates",
        "description": "Retrieve list of Nintex templates available for use",
        "operationId": "ListTemplates",
        "responses": {
          "200": {
            "description": "Templates retrieved",
            "schema": {
              "type": "object",
              "properties": {
                "value": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "cs_templateid": {
                        "type": "string",
                        "description": "Template ID"
                      },
                      "cs_name": {
                        "type": "string",
                        "description": "Template name"
                      },
                      "cs_description": {
                        "type": "string",
                        "description": "Template description"
                      },
                      "cs_nintextemplateid": {
                        "type": "string",
                        "description": "Nintex template ID (use this in envelope submission)"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "definitions": {},
  "parameters": {},
  "responses": {},
  "tags": []
}
